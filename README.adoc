= Feedback

// tag::intro[]

[.tagline]
A simple to use feedback system for CMake based C++ projects.

[horizontal.shields]

// end::intro[]

== License

// tag::license[]

Distributed under the [MIT](https://opensource.org/licenses/MIT) license.

// end::license[]

== Features

// tag::features[]

* Define new feedback rules within minutes

// end::features[]

== Using

// tag::using[]

To use, integrate the feedback system into your CMake project:

[source,cmake]
----
include (FetchContent)

FetchContent_Declare (feedback_content GIT_REPOSITORY "https://github.com/volumegraphics/feedback.git" GIT_TAG 1.0.0)
FetchContent_MakeAvailable (feedback_content)
----

You can also add feedback as subdirectory if you store its sources side-by-side:

[source,cmake]
----
add_subdirectory (path_to_feedback)
----

A feedback can then be created like this:

[source,cmake]
----
# add_library (...)
add_executable (example main.cpp)

Feedback_FindTargets (all_targets DIRECTORY .)
Feedback_Add (CodingGuidelines RULES rules.json TARGETS ${all_targets})

# Optional, but recommended setting to group all feedback targets
set_property(GLOBAL PROPERTY USE_FOLDERS true)
----

Where your feedback rules (`rules.json`) are like this:

[source,json]
----
{
  "RULE1": {
    "type": "requirement",
    "matched_files": "[.](c|cc|cpp|cxx|h|i)([.]in)?$",
    "ignored_files": "^$",
    "matched_text": "\t",
    "ignored_text": "^$",
    "marked_text": ".*",
    "summary": "Don't use tabulators in source files",
    "rationale": "Developers who use spaces make more money than those who use tabs. See also: https://stackoverflow.blog/2017/06/15/developers-use-spaces-make-money-use-tabs/",
    "workaround": "Please replace all tabulators with spaces and adjust your editor settings accordingly."
  },
  "RULE2": {
    "type": "guideline",
    "matched_files": "[.](c|cc|cpp|cxx|h|i)([.]in)?$",
    "ignored_files": "^$",
    "matched_text": "^ *# *include *([<][^>]*|[\"][^\"]*)[\\\\]",
    "ignored_text": "^$",
    "marked_text": "[\\\\]",
    "summary": "Don't use backslashes in include directives",
    "rationale": "Non Windows systems may not recognize a backslash as path delimiter.",
    "workaround": "Please replace all backslashes with forward slashes in include directives."
  },
  "RULE3": {
    "type": "improvement",
    "matched_files": "[.](c|cc|cpp|cxx|h|i)([.]in)?$",
    "ignored_files": "^$",
    "matched_text": "^ *# *include *([<][^>]*|[\"][^\"]*)//",
    "ignored_text": "^$",
    "marked_text": "//",
    "summary": "Duplicate forward slash in include directive",
    "rationale": "Such typos are ignored by most compilers, but they complicate automated refactorings.",
    "workaround": "Please remove the redundant forward slash."
  },
  "RULE4": {
    "type": "suggestion",
    "matched_files": "[.](c|cc|cpp|cxx|h|i)([.]in)?$",
    "ignored_files": "^$",
    "matched_text": "// *(TODO|FIXME|REVIEW|OPTIMIZE|HACK|XXX|BUG)",
    "ignored_text": "^$",
    "marked_text": "[A-Z]+",
    "summary": "Unfinished task (TODO/FIXME/HACK/...)",
    "rationale": "Task markers should be used only rarely and temporarily in our code base because they indicate a technical debt. They tend to rot over time and will be forgotton eventually.",
    "workaround": "Please finish this task if possible. Remove its marker from our code base either way. Use an issue tracker like JIRA for important tasks."
  }
}
----

You can exclude certain targets from feedback:

[source,cmake]
----
add_executable (no_feedback ...)
Feedback_Exclude (no_feedback)

Feedback_FindTargets (all_targets DIRECTORY .)
Feedback_Add (CodingGuidelines RULES rules.json TARGETS ${all_targets})
----

// end::using[]
